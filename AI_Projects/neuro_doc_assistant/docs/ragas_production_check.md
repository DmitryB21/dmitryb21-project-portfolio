# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RAGAS –º–µ—Ç—Ä–∏–∫ –≤ Production

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ UI

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**

**–§–∞–π–ª:** `app/ui/streamlit_app.py`

**–ö–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫:**
```python
def display_metrics(metrics: Dict[str, float]):
    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞"""
    if not metrics:
        return
    
    st.subheader("üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞")
    
    # –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    col1, col2, col3 = st.columns(3)
    
    with col1:
        if "precision_at_3" in metrics:
            precision = metrics["precision_at_3"]
            st.metric("Precision@3", f"{precision:.2%}")
    
    with col2:
        if "faithfulness" in metrics:  # ‚úÖ RAGAS –º–µ—Ç—Ä–∏–∫–∞
            faithfulness = metrics["faithfulness"]
            st.metric("Faithfulness", f"{faithfulness:.2f}")
    
    with col3:
        if "answer_relevancy" in metrics:  # ‚úÖ RAGAS –º–µ—Ç—Ä–∏–∫–∞
            relevancy = metrics["answer_relevancy"]
            st.metric("Answer Relevancy", f"{relevancy:.2f}")
```

**–í—ã–≤–æ–¥:** UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ–±–µ RAGAS –º–µ—Ç—Ä–∏–∫–∏ (`faithfulness` –∏ `answer_relevancy`).

---

### 2. –ü–µ—Ä–µ–¥–∞—á–∞ –º–µ—Ç—Ä–∏–∫ –∏–∑ API –≤ UI

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**

**–§–∞–π–ª:** `app/ui/streamlit_app.py` (—Å—Ç—Ä–æ–∫–∏ 361-387)

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```python
# 1. –ó–∞–ø—Ä–æ—Å –∫ API
response = ask_agent(prompt, k=k)

# 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏–∑ –æ—Ç–≤–µ—Ç–∞
if response:
    answer = response.get("answer", "–û—Ç–≤–µ—Ç –Ω–µ –ø–æ–ª—É—á–µ–Ω")
    sources = response.get("sources", [])
    metrics = response.get("metrics", {})  # ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –∏–∑ API
    
    # 3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
    if metrics:
        display_metrics(metrics)  # ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

**–í—ã–≤–æ–¥:** –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏–∑ API response –≤ UI –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è.

---

### 3. –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –≤ AgentController

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**

**–§–∞–π–ª:** `app/agent/agent.py` (—Å—Ç—Ä–æ–∫–∏ 353-361)

**–ö–æ–¥:**
```python
# RAGAS –º–µ—Ç—Ä–∏–∫–∏
contexts = [chunk.text for chunk in retrieved_chunks]
ragas_metrics = self.ragas_evaluator.evaluate_all(
    question=query,
    answer=answer,
    contexts=contexts,
    ground_truth=None
)
metrics.update(ragas_metrics)  # ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ RAGAS –º–µ—Ç—Ä–∏–∫ –≤ –æ–±—â–∏–π —Å–ª–æ–≤–∞—Ä—å
```

**–í—ã–≤–æ–¥:** RAGAS –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `metrics`.

---

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Real RAGAS –≤ Production

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

**–§–∞–π–ª:** `app/main.py` (—Å—Ç—Ä–æ–∫–∏ 95-120)

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```python
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ —Ä–µ–∞–ª—å–Ω—ã–π RAGAS –∏–ª–∏ mock mode
use_ragas_mock = os.getenv("RAGAS_MOCK_MODE", "false").lower() == "true"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ (—Ç—Ä–µ–±—É—é—Ç langchain-core)
if use_ragas_mock or not RAGAS_ADAPTERS_AVAILABLE:
    if not RAGAS_ADAPTERS_AVAILABLE:
        print("‚ö†Ô∏è  LangChain –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. RAGAS –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ mock mode.")
        print("   –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ RAGAS —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install langchain-core langchain-community")
    ragas_evaluator = RAGASEvaluator(mock_mode=True)  # ‚ùå Mock mode
else:
    try:
        # –°–æ–∑–¥–∞—ë–º –∞–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è RAGAS
        llm_adapter = GigaChatLLMAdapter(llm_client=llm_client)
        embeddings_adapter = GigaChatEmbeddingsAdapter(embedding_service=embedding_service)
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º RAGAS evaluator —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏
        ragas_evaluator = RAGASEvaluator(
            mock_mode=False,  # ‚úÖ Real RAGAS
            llm_adapter=llm_adapter,
            embeddings_adapter=embeddings_adapter
        )
    except Exception as e:
        print(f"‚ö†Ô∏è  –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ RAGAS –∞–¥–∞–ø—Ç–µ—Ä–æ–≤: {e}")
        print("   RAGAS –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ mock mode.")
        ragas_evaluator = RAGASEvaluator(mock_mode=True)  # ‚ùå Fallback –∫ mock mode
```

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è mock mode**, –µ—Å–ª–∏:
   - `RAGAS_MOCK_MODE=true` (—è–≤–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
   - `langchain-core` –∏–ª–∏ `langchain-community` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
   - –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤

2. **–î–ª—è production –Ω—É–∂–Ω–æ —è–≤–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `ragas`, `langchain-core`, `langchain-community`
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `RAGAS_MOCK_MODE=false` –≤ `.env`
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `GIGACHAT_AUTH_KEY` –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã RAGAS

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–æ–π —Ä–µ–∂–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

#### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ API

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ API –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ:

**Mock Mode:**
```
‚ö†Ô∏è  LangChain –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. RAGAS –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ mock mode.
   –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ RAGAS —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install langchain-core langchain-community
```

**Real RAGAS:**
```
(–ù–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π - –∑–Ω–∞—á–∏—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è real RAGAS)
```

#### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫

**Mock Mode –∑–Ω–∞—á–µ–Ω–∏—è:**
- `faithfulness`: 0.90 (–µ—Å–ª–∏ –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞) –∏–ª–∏ 0.50
- `answer_relevancy`: 0.85 (–µ—Å–ª–∏ –µ—Å—Ç—å –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤) –∏–ª–∏ 0.60

**Real RAGAS –∑–Ω–∞—á–µ–Ω–∏—è:**
- `faithfulness`: –î–∏–∞–ø–∞–∑–æ–Ω 0.0-1.0, –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.87, 0.92, 0.75)
- `answer_relevancy`: –î–∏–∞–ø–∞–∑–æ–Ω 0.0-1.0, –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.83, 0.91, 0.68)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Real RAGAS –¥–∞—ë—Ç –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∏ —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ mock mode –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞

**Mock Mode:** –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (~0.001 —Å–µ–∫)

**Real RAGAS:** –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –¥–æ–ª—å—à–µ (~5-10 —Å–µ–∫—É–Ω–¥), —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É—é—Ç –≤—ã–∑–æ–≤–æ–≤ LLM

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è Production

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install ragas>=0.4.0 langchain-core langchain-community
```

–ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å `requirements.txt` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í —Ñ–∞–π–ª–µ `.env` –¥–ª—è production:

```env
# –û—Ç–∫–ª—é—á–∏—Ç—å mock mode –¥–ª—è RAGAS
RAGAS_MOCK_MODE=false

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GigaChat API (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è real RAGAS)
GIGACHAT_AUTH_KEY=your_base64_encoded_client_id_client_secret
GIGACHAT_SCOPE=GIGACHAT_API_PERS
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
python scripts/test_ragas_integration.py
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –ª–∏ –∞–¥–∞–ø—Ç–µ—Ä—ã
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ª–∏ RAGASEvaluator —Å real RAGAS
- ‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ –æ—Ü–µ–Ω–∫–∞ –º–µ—Ç—Ä–∏–∫

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Production

–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ RAGAS –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:

```python
# –í app/main.py –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ragas_evaluator
if ragas_evaluator.mock_mode:
    print("‚ö†Ô∏è  RAGAS —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ MOCK MODE - –º–µ—Ç—Ä–∏–∫–∏ –Ω–µ —Ç–æ—á–Ω—ã–µ!")
else:
    print("‚úÖ RAGAS —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ REAL MODE - –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω—ã–µ")
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. ‚úÖ **UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç RAGAS –º–µ—Ç—Ä–∏–∫–∏** (`faithfulness` –∏ `answer_relevancy`)
2. ‚úÖ **–ú–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏–∑ API –≤ UI** —á–µ—Ä–µ–∑ `response.get("metrics", {})`
3. ‚úÖ **–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ AgentController** —á–µ—Ä–µ–∑ `ragas_evaluator.evaluate_all()`
4. ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç real RAGAS** —á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä—ã

### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Production:

1. ‚ö†Ô∏è **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `ragas`, `langchain-core`, `langchain-community`
2. ‚ö†Ô∏è **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `RAGAS_MOCK_MODE=false`** –≤ `.env`
3. ‚ö†Ô∏è **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å `GIGACHAT_AUTH_KEY`** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GigaChat API
4. ‚ö†Ô∏è **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ API (–ø–æ –ª–æ–≥–∞–º)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤ UI

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API —Å real RAGAS:
   ```bash
   # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RAGAS_MOCK_MODE=false –≤ .env
   python app/main.py
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Streamlit UI:
   ```bash
   streamlit run app/ui/streamlit_app.py
   ```

3. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –≤ UI –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ª–∏ –º–µ—Ç—Ä–∏–∫–∏ `Faithfulness` –∏ `Answer Relevancy`
   - ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0.0-1.0
   - ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (0.90/0.85), –∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API –Ω–∞–ø—Ä—è–º—É—é

```bash
curl -X POST http://localhost:8000/ask \
  -H "Content-Type: application/json" \
  -d '{"query": "–ö–∞–∫–æ–π SLA —É —Å–µ—Ä–≤–∏—Å–∞ –ø–ª–∞—Ç–µ–∂–µ–π?", "k": 3}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "answer": "...",
  "sources": [...],
  "metrics": {
    "faithfulness": 0.87,      // ‚úÖ RAGAS –º–µ—Ç—Ä–∏–∫–∞ (real mode)
    "answer_relevancy": 0.83   // ‚úÖ RAGAS –º–µ—Ç—Ä–∏–∫–∞ (real mode)
  }
}
```

---

## üìù –í—ã–≤–æ–¥—ã

1. **UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç RAGAS –º–µ—Ç—Ä–∏–∫–∏** - –æ–±–µ –º–µ—Ç—Ä–∏–∫–∏ (`faithfulness` –∏ `answer_relevancy`) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Streamlit UI

2. **–ú–µ—Ç—Ä–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏–∑ API** - –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö: AgentController ‚Üí API Response ‚Üí UI —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

3. **–î–ª—è production —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è real RAGAS
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `RAGAS_MOCK_MODE=false`
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GigaChat API –∫–ª—é—á–∏

4. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ RAGAS –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ –≤ UI (mock/real)
   - –ü—Ä–æ–≤–µ—Ä–∫—É —Ä–µ–∂–∏–º–∞ –≤ health check endpoint

---

## üîß –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ RAGAS –≤ UI

–í `app/ui/streamlit_app.py` –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞:

```python
# –í sidebar –ø–æ—Å–ª–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
st.divider()
st.subheader("üìä –†–µ–∂–∏–º RAGAS")
# –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ RAGAS
```

### 2. –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞

–í `app/api/admin.py` –¥–æ–±–∞–≤–∏—Ç—å:

```python
@router.get("/ragas/mode")
async def get_ragas_mode():
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã RAGAS"""
    return {
        "mode": "real" if not controller.ragas_evaluator.mock_mode else "mock",
        "available": controller.ragas_evaluator.ragas_available
    }
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ health check

–í `app/api/chat.py` –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∂–∏–º–µ RAGAS –≤ health check.

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**RAGAS –º–µ—Ç—Ä–∏–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.** –î–ª—è production –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `RAGAS_MOCK_MODE=false`
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GigaChat API –∫–ª—é—á–∏
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤ –≤ production –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è **real RAGAS –º–µ—Ç—Ä–∏–∫–∏** —Å —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤.

