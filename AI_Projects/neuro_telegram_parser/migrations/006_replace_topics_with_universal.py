"""
–ú–∏–≥—Ä–∞—Ü–∏—è 006: –ó–∞–º–µ–Ω–∞ —Ç–µ–º –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫
–ó–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–º—ã –Ω–∞ –Ω–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ 12 —Ç–µ–º
–ó–∞–ø—É—Å–∫: python migrations/006_replace_topics_with_universal.py
"""

import psycopg2
import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ config_utils
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from config_utils import get_config

# –ù–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —Ç–µ–º
UNIVERSAL_TOPICS = [
    {
        "name": "–ù–æ–≤–æ—Å—Ç–∏ –∏ –æ–±—â–µ—Å—Ç–≤–æ",
        "description": "–ü–æ–ª–∏—Ç–∏–∫–∞, –≤—ã–±–æ—Ä—ã, –∑–∞–∫–æ–Ω—ã, –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –≥–µ–æ–ø–æ–ª–∏—Ç–∏–∫–∞, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–æ—Ç–µ—Å—Ç—ã, –º–∏–≥—Ä–∞—Ü–∏—è, –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è, –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã, –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.",
        "synonyms": ["–ø–æ–ª–∏—Ç–∏–∫–∞", "–≤—ã–±–æ—Ä—ã", "–∑–∞–∫–æ–Ω—ã", "–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è", "–≥–µ–æ–ø–æ–ª–∏—Ç–∏–∫–∞", "—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã", "–ø—Ä–æ—Ç–µ—Å—Ç—ã", "–º–∏–≥—Ä–∞—Ü–∏—è", "–ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è", "–æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã", "–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è", "–æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–Ω–æ–≤–æ—Å—Ç–∏", "–æ–±—â–µ—Å—Ç–≤–æ"],
        "color": "#FF6B6B"
    },
    {
        "name": "–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã",
        "description": "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ, —Å—Ç–∞—Ä—Ç–∞–ø—ã, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, —Ñ–æ–Ω–¥–æ–≤—ã–π —Ä—ã–Ω–æ–∫, –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã, –±–ª–æ–∫—á–µ–π–Ω, –±–∞–Ω–∫–∏, –Ω–∞–ª–æ–≥–∏, –ª–∏—á–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã, –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∫–∞—Ä—å–µ—Ä–∞, HR, —Ä—ã–Ω–∫–∏ —Ç—Ä—É–¥–∞, —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–Ω–¥—ã.",
        "synonyms": ["–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ", "—Å—Ç–∞—Ä—Ç–∞–ø—ã", "–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", "—Ñ–æ–Ω–¥–æ–≤—ã–π —Ä—ã–Ω–æ–∫", "–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã", "–±–ª–æ–∫—á–µ–π–Ω", "–±–∞–Ω–∫–∏", "–Ω–∞–ª–æ–≥–∏", "–ª–∏—á–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã", "–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞", "—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", "–∫–∞—Ä—å–µ—Ä–∞", "HR", "—Ä—ã–Ω–∫–∏ —Ç—Ä—É–¥–∞", "—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–Ω–¥—ã", "–±–∏–∑–Ω–µ—Å", "—Ñ–∏–Ω–∞–Ω—Å—ã", "—ç–∫–æ–Ω–æ–º–∏–∫–∞"],
        "color": "#4ECDC4"
    },
    {
        "name": "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –Ω–∞—É–∫–∞",
        "description": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –≥–∞–¥–∂–µ—Ç—ã, –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –Ω–∞—É–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏, –∫–æ—Å–º–æ—Å, —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞, –∏–Ω–∂–µ–Ω–µ—Ä–∏—è, —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è.",
        "synonyms": ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "–≥–∞–¥–∂–µ—Ç—ã", "–∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–Ω–∞—É–∫–∞", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–∏–Ω–Ω–æ–≤–∞—Ü–∏–∏", "–∫–æ—Å–º–æ—Å", "—Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞", "–∏–Ω–∂–µ–Ω–µ—Ä–∏—è", "—Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è", "IT", "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–Ω–∞—É–∫–∞"],
        "color": "#45B7D1"
    },
    {
        "name": "–ö—É–ª—å—Ç—É—Ä–∞ –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ",
        "description": "–ò—Å–∫—É—Å—Å—Ç–≤–æ, –∂–∏–≤–æ–ø–∏—Å—å, —Å–∫—É–ª—å–ø—Ç—É—Ä–∞, –∫–∏–Ω–æ, –º—É–∑—ã–∫–∞, —Ç–µ–∞—Ç—Ä, –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞, –∫–Ω–∏–≥–∏, –ø–æ—ç–∑–∏—è, –¥–∏–∑–∞–π–Ω, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è, –º–æ–¥–∞, –∫—É–ª—å—Ç—É—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è, –≤—ã—Å—Ç–∞–≤–∫–∏, —Ñ–µ—Å—Ç–∏–≤–∞–ª–∏, —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã.",
        "synonyms": ["–∏—Å–∫—É—Å—Å—Ç–≤–æ", "–∂–∏–≤–æ–ø–∏—Å—å", "—Å–∫—É–ª—å–ø—Ç—É—Ä–∞", "–∫–∏–Ω–æ", "–º—É–∑—ã–∫–∞", "—Ç–µ–∞—Ç—Ä", "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", "–∫–Ω–∏–≥–∏", "–ø–æ—ç–∑–∏—è", "–¥–∏–∑–∞–π–Ω", "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", "—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è", "–º–æ–¥–∞", "–∫—É–ª—å—Ç—É—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è", "–≤—ã—Å—Ç–∞–≤–∫–∏", "—Ñ–µ—Å—Ç–∏–≤–∞–ª–∏", "—Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã", "–∫—É–ª—å—Ç—É—Ä–∞", "—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ"],
        "color": "#FFA07A"
    },
    {
        "name": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ",
        "description": "–û–±—É—á–µ–Ω–∏–µ, –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã, —à–∫–æ–ª–∞, —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç, –Ω–∞–≤—ã–∫–∏, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è, –º–æ—Ç–∏–≤–∞—Ü–∏—è, –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, –∫–æ—É—á–∏–Ω–≥, —Å–∞–º–æ—Ä–µ—Ñ–ª–µ–∫—Å–∏—è, —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–∏–≤—ã—á–µ–∫, soft skills, –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏.",
        "synonyms": ["–æ–±—É—á–µ–Ω–∏–µ", "–æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã", "—à–∫–æ–ª–∞", "—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç", "–Ω–∞–≤—ã–∫–∏", "–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è", "–º–æ—Ç–∏–≤–∞—Ü–∏—è", "–ª–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç", "—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–∫–æ—É—á–∏–Ω–≥", "—Å–∞–º–æ—Ä–µ—Ñ–ª–µ–∫—Å–∏—è", "—Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–∏–≤—ã—á–µ–∫", "soft skills", "–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", "—Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ"],
        "color": "#98D8C8"
    },
    {
        "name": "–ë—ã—Ç –∏ –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏",
        "description": "–ó–¥–æ—Ä–æ–≤—å–µ, —Ñ–∏—Ç–Ω–µ—Å, –ø–∏—Ç–∞–Ω–∏–µ, –ó–û–ñ, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, —Ç—É—Ä–∏–∑–º, –∫—É–ª–∏–Ω–∞—Ä–∏—è, —Ä–µ—Ü–µ–ø—Ç—ã, –∏–Ω—Ç–µ—Ä—å–µ—Ä, —Ä–µ–º–æ–Ω—Ç, –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Å–∞–¥–æ–≤–æ–¥—Å—Ç–≤–æ, –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ, —É—Ö–æ–¥ –∑–∞ —Å–æ–±–æ–π, –ª–∞–π—Ñ—Ö–∞–∫–∏ –¥–ª—è –¥–æ–º–∞ –∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏.",
        "synonyms": ["–∑–¥–æ—Ä–æ–≤—å–µ", "—Ñ–∏—Ç–Ω–µ—Å", "–ø–∏—Ç–∞–Ω–∏–µ", "–ó–û–ñ", "–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è", "—Ç—É—Ä–∏–∑–º", "–∫—É–ª–∏–Ω–∞—Ä–∏—è", "—Ä–µ—Ü–µ–ø—Ç—ã", "–∏–Ω—Ç–µ—Ä—å–µ—Ä", "—Ä–µ–º–æ–Ω—Ç", "–±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", "—Å–∞–¥–æ–≤–æ–¥—Å—Ç–≤–æ", "–¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ", "—É—Ö–æ–¥ –∑–∞ —Å–æ–±–æ–π", "–ª–∞–π—Ñ—Ö–∞–∫–∏", "–±—ã—Ç", "–æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏"],
        "color": "#F7DC6F"
    },
    {
        "name": "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞",
        "description": "–ò–≥—Ä—ã, –≥–µ–π–º–∏–Ω–≥, –∫–∏–±–µ—Ä—Å–ø–æ—Ä—Ç, —é–º–æ—Ä, –º–µ–º—ã, —à—É—Ç–∫–∏, —à–æ—É-–±–∏–∑–Ω–µ—Å, —Ä–µ–∞–ª–∏—Ç–∏-—à–æ—É, TikTok, YouTube, —Å—Ç—Ä–∏–º–∏–Ω–≥, –≤–∏—Ä—É—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç, —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —à–æ—É, –∫–∏–Ω–æ–æ–±–∑–æ—Ä—ã, –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Ä–µ–ª–∏–∑—ã.",
        "synonyms": ["–∏–≥—Ä—ã", "–≥–µ–π–º–∏–Ω–≥", "–∫–∏–±–µ—Ä—Å–ø–æ—Ä—Ç", "—é–º–æ—Ä", "–º–µ–º—ã", "—à—É—Ç–∫–∏", "—à–æ—É-–±–∏–∑–Ω–µ—Å", "—Ä–µ–∞–ª–∏—Ç–∏-—à–æ—É", "TikTok", "YouTube", "—Å—Ç—Ä–∏–º–∏–Ω–≥", "–≤–∏—Ä—É—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç", "—Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —à–æ—É", "–∫–∏–Ω–æ–æ–±–∑–æ—Ä—ã", "–º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Ä–µ–ª–∏–∑—ã", "—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", "–º–µ–¥–∏–∞"],
        "color": "#BB8FCE"
    },
    {
        "name": "–ü—Ä–∏—Ä–æ–¥–∞ –∏ —ç–∫–æ–ª–æ–≥–∏—è",
        "description": "–ñ–∏–≤–æ—Ç–Ω—ã–µ, —Ä–∞—Å—Ç–µ–Ω–∏—è, —ç–∫–æ–ª–æ–≥–∏—è, –æ—Ö—Ä–∞–Ω–∞ –ø—Ä–∏—Ä–æ–¥—ã, –∫–ª–∏–º–∞—Ç, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–ª–∏–º–∞—Ç–∞, —É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞, –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ, –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∫–∏, –±–∏–æ—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ, —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã, –∑–æ–æ–ª–æ–≥–∏—è, –±–æ—Ç–∞–Ω–∏–∫–∞.",
        "synonyms": ["–∂–∏–≤–æ—Ç–Ω—ã–µ", "—Ä–∞—Å—Ç–µ–Ω–∏—è", "—ç–∫–æ–ª–æ–≥–∏—è", "–æ—Ö—Ä–∞–Ω–∞ –ø—Ä–∏—Ä–æ–¥—ã", "–∫–ª–∏–º–∞—Ç", "–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–ª–∏–º–∞—Ç–∞", "—É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ", "–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞", "–∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ", "–Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∫–∏", "–±–∏–æ—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ", "—ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã", "–∑–æ–æ–ª–æ–≥–∏—è", "–±–æ—Ç–∞–Ω–∏–∫–∞", "–ø—Ä–∏—Ä–æ–¥–∞", "—ç–∫–æ–ª–æ–≥–∏—è"],
        "color": "#52BE80"
    },
    {
        "name": "–†–µ–ª–∏–≥–∏—è –∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è",
        "description": "–í–µ—Ä–∞, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å, —Ä–µ–ª–∏–≥–∏–∏ –º–∏—Ä–∞, —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è, —ç—Ç–∏–∫–∞, —Å–º—ã—Å–ª –∂–∏–∑–Ω–∏, –º–µ–¥–∏—Ç–∞—Ü–∏—è, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏, —Ç—Ä–∞–¥–∏—Ü–∏–∏, –º–æ—Ä–∞–ª—å, —ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã, –¥—É—Ö–æ–≤–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.",
        "synonyms": ["–≤–µ—Ä–∞", "–¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å", "—Ä–µ–ª–∏–≥–∏–∏ –º–∏—Ä–∞", "—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è", "—ç—Ç–∏–∫–∞", "—Å–º—ã—Å–ª –∂–∏–∑–Ω–∏", "–º–µ–¥–∏—Ç–∞—Ü–∏—è", "—Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏", "—Ç—Ä–∞–¥–∏—Ü–∏–∏", "–º–æ—Ä–∞–ª—å", "—ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã", "—Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã", "–¥—É—Ö–æ–≤–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏", "—Ä–µ–ª–∏–≥–∏—è", "—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è"],
        "color": "#85C1E9"
    },
    {
        "name": "Telegram –∏ —Ü–∏—Ñ—Ä–æ–≤–∞—è —Å—Ä–µ–¥–∞",
        "description": "–ù–æ–≤–æ—Å—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Telegram, —Ñ—É–Ω–∫—Ü–∏–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞, –ø–æ–¥–±–æ—Ä–∫–∏ –∫–∞–Ω–∞–ª–æ–≤, —Å–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, —Ü–∏—Ñ—Ä–æ–≤–∞—è –≥–∏–≥–∏–µ–Ω–∞, –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏, –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã, –æ–Ω–ª–∞–π–Ω-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è, —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫—É–ª—å—Ç—É—Ä–∞.",
        "synonyms": ["Telegram", "–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä", "–ø–æ–¥–±–æ—Ä–∫–∏ –∫–∞–Ω–∞–ª–æ–≤", "—Ü–∏—Ñ—Ä–æ–≤–∞—è –≥–∏–≥–∏–µ–Ω–∞", "–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å", "—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏", "–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã", "–æ–Ω–ª–∞–π–Ω-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è", "—Ü–∏—Ñ—Ä–æ–≤–∞—è –∫—É–ª—å—Ç—É—Ä–∞", "—Ü–∏—Ñ—Ä–æ–≤–∞—è —Å—Ä–µ–¥–∞"],
        "color": "#3498DB"
    },
    {
        "name": "–õ–∏—á–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ –∏ –º–Ω–µ–Ω–∏—è",
        "description": "–ê–≤—Ç–æ—Ä—Å–∫–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è, –ª–∏—á–Ω—ã–π –æ–ø—ã—Ç, –¥–Ω–µ–≤–Ω–∏–∫–∏, —ç—Å—Å–µ, —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ –º–Ω–µ–Ω–∏—è, –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∂–∏–∑–Ω–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è, –ª–∏—á–Ω—ã–µ –≤–∑–≥–ª—è–¥—ã –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–µ–º–µ.",
        "synonyms": ["–∞–≤—Ç–æ—Ä—Å–∫–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è", "–ª–∏—á–Ω—ã–π –æ–ø—ã—Ç", "–¥–Ω–µ–≤–Ω–∏–∫–∏", "—ç—Å—Å–µ", "—Å—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ –º–Ω–µ–Ω–∏—è", "–Ω–∞–±–ª—é–¥–µ–Ω–∏—è", "–∂–∏–∑–Ω–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏", "—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è", "–ª–∏—á–Ω—ã–µ –≤–∑–≥–ª—è–¥—ã", "–ª–∏—á–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏", "–º–Ω–µ–Ω–∏—è"],
        "color": "#E8DAEF"
    },
    {
        "name": "–î—Ä—É–≥–æ–µ / –ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ",
        "description": "–ö–æ—Ä–æ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ —Å–º—ã—Å–ª–∞, —Å–ø–∞–º, –Ω–µ—Ä–∞–∑–±–æ—Ä—á–∏–≤—ã–π —Ç–µ–∫—Å—Ç, —Ä–µ–∫–ª–∞–º–∞ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –Ω–µ –ø–æ–¥–¥–∞—é—â–∏–π—Å—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç, —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞.",
        "synonyms": ["—Å–ø–∞–º", "—Ä–µ–∫–ª–∞–º–∞", "—Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è", "–æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞", "–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ", "–¥—Ä—É–≥–æ–µ"],
        "color": "#95A5A6"
    }
]


def replace_topics():
    """–ó–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–º—ã –Ω–∞ –Ω–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫"""
    config = get_config()
    
    if 'postgresql' not in config or 'dsn' not in config['postgresql']:
        print("–û—à–∏–±–∫–∞: –í —Ñ–∞–π–ª–µ config.ini –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–µ–∫—Ü–∏—è [postgresql] –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä dsn.")
        sys.exit(1)
    
    POSTGRES_DSN = config['postgresql']['dsn']
    
    try:
        conn = psycopg2.connect(POSTGRES_DSN)
        cur = conn.cursor()
        
        print("üîÑ –ó–∞–º–µ–Ω–∞ —Ç–µ–º –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫...")
        print(f"üìã –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ/–æ–±–Ω–æ–≤–ª–µ–Ω–æ {len(UNIVERSAL_TOPICS)} —Ç–µ–º")
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ–º –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        cur.execute("SELECT COUNT(*) FROM topics")
        old_count = cur.fetchone()[0]
        print(f"üìä –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–º –≤ –ë–î: {old_count}")
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Å–≤—è–∑–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ç–µ–º–∞–º–∏ (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å foreign key)
        print("üßπ –û—á–∏—Å—Ç–∫–∞ —Å–≤—è–∑–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ç–µ–º–∞–º–∏...")
        cur.execute("DELETE FROM message_topics")
        deleted_links = cur.rowcount
        print(f"   –£–¥–∞–ª–µ–Ω–æ —Å–≤—è–∑–µ–π: {deleted_links}")
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Ç–µ–º—ã
        print("üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ç–µ–º...")
        cur.execute("DELETE FROM topics")
        deleted_topics = cur.rowcount
        print(f"   –£–¥–∞–ª–µ–Ω–æ —Ç–µ–º: {deleted_topics}")
        
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å ID (—á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å 1)
        cur.execute("ALTER SEQUENCE topics_id_seq RESTART WITH 1")
        print("üîÑ –°–±—Ä–æ—Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ID —Ç–µ–º")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ç–µ–º—ã
        print("\nüìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–º...")
        for idx, topic in enumerate(UNIVERSAL_TOPICS, 1):
            cur.execute("""
                INSERT INTO topics (name, description, synonyms, color)
                VALUES (%s, %s, %s, %s)
            """, (
                topic['name'],
                topic['description'],
                topic['synonyms'],
                topic['color']
            ))
            print(f"   ‚úÖ {idx}. {topic['name']}")
        
        conn.commit()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        cur.execute("SELECT COUNT(*) FROM topics")
        new_count = cur.fetchone()[0]
        
        print(f"\n‚úÖ –ó–∞–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
        print(f"   –°—Ç–∞—Ä—ã—Ö —Ç–µ–º: {deleted_topics}")
        print(f"   –ù–æ–≤—ã—Ö —Ç–µ–º: {new_count}")
        print(f"   –£–¥–∞–ª–µ–Ω–æ —Å–≤—è–∑–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ç–µ–º–∞–º–∏: {deleted_links}")
        print(f"\n‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í—Å–µ —Å–≤—è–∑–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ç–µ–º–∞–º–∏ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã.")
        print(f"   –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ.")
        print(f"\nüí° –ö–µ—à —ç—Ç–∞–ª–æ–Ω–æ–≤ —Ç–µ–º –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.")
        
        cur.close()
        conn.close()
        
        # –ü—ã—Ç–∞–µ–º—Å—è –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à, –µ—Å–ª–∏ ClassificationService –¥–æ—Å—Ç—É–ø–µ–Ω
        try:
            from pro_mode.classification_service import ClassificationService
            
            # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–µ—Ä–≤–∏—Å–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –±–µ–∑ async)
            service = ClassificationService()
            service.invalidate_cache()
            print("‚úÖ –ö–µ—à —ç—Ç–∞–ª–æ–Ω–æ–≤ —Ç–µ–º –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω")
        except ImportError:
            print("‚ö†Ô∏è ClassificationService –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)")
            print(f"   –ö–µ—à –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.")
        except Exception as e:
            print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: {e}")
            print(f"   –ö–µ—à –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ —Ç–µ–º: {e}")
        if 'conn' in locals() and conn:
            conn.rollback()
        sys.exit(1)


if __name__ == "__main__":
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    print("=" * 60)
    print("‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è —É–¥–∞–ª–∏—Ç –í–°–ï —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–º—ã")
    print("   –∏ –∑–∞–º–µ–Ω–∏—Ç –∏—Ö –Ω–∞ –Ω–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ 12 —Ç–µ–º.")
    print("   –¢–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –í–°–ï —Å–≤—è–∑–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ç–µ–º–∞–º–∏.")
    print("=" * 60)
    
    response = input("\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/no): ").strip().lower()
    if response not in ['yes', 'y', '–¥–∞', '–¥']:
        print("‚ùå –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞.")
        sys.exit(0)
    
    replace_topics()

